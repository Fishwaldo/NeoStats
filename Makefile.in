# Makefile for GeoStats
# GeoStats CVS Identification
# $Id: Makefile.in,v 1.24 2002/08/20 09:30:37 fishwaldo Exp $
# makefile originally created by Andy Church.
include Makefile.inc 


OBJS =	dns.o chans.o dotconf.o services.o main.o sock.o conf.o ircd.o timer.o users.o \
		ns_help.o dl.o list.o hash.o server.o @IRCD_FILES_OBJS@
SRCS =	dns.c chans.c dotconf.c services.c main.c sock.c conf.c ircd.c timer.c users.c \
		ns_help.c dl.c list.c hash.c server.c @IRCD_FILES_SRC@

PROGS = neostats chkstats makeconf
CONF = neostats.cfg.dist
DOCS = doc/FAQ doc/USERMAN README BUGS AUTHORS COPYING INSTALL LICENCE NEWS TODO
DOCS_PROGS = doc/read-faq doc/read-userman
DATA = data/tlds.nfo
INCLUDES = config.h dl.h dotconf.h hash.h list.h stats.h Ultimate.h Unreal.h adns/adns.h

.c.o:
	$(CC) $(NEOINCLUDES) $(CFLAGS) -c $< 2>> make.log


all: 	libadns.a neostats modules

modules:
	(cd dl; $(MAKE) $@)

libadns.a:
	(cd adns; $(MAKE) $@)


clean:
	(cd dl; $(MAKE) $@)
	(cd adns; $(MAKE) $@)
	/bin/rm -rf *.o neostats *.cache Makefile config.status config.h  Makefile.inc *.log *.a


neostats: $(OBJS)
	$(CC) $(LDFLAGS) $(OBJS) adns/libadns.a -o $@

install: neostats modules
	$(INSTALL) -m 755 -d @prefix@
	$(INSTALL) -m 755 -d @prefix@/dl
	$(INSTALL) -m 755 -d @prefix@/include
	$(INSTALL) -m 755 -d @prefix@/doc
	$(INSTALL) -m 755 -d @prefix@/data
	$(INSTALL) -m 750 -d @prefix@/logs
	$(INSTALL) -m 755 $(PROGS) @prefix@
	$(INSTALL) -m 644 $(CONF) @prefix@
	$(INSTALL) -m 644 $(DOCS) @prefix@/doc
	$(INSTALL) -m 755 $(DOCS_PROGS) @prefix@/doc
	$(INSTALL) -m 644 $(DATA) @prefix@/data
	$(INSTALL) -m 644 $(INCLUDES) @prefix@/include
	(cd dl; $(MAKE) $@)

# Catch any changes in compilation options at the top of this file
$(OBJS): Makefile

dotconf.o:	dotconf.c	stats.h		config.h	dotconf.h	Makefile.inc
services.o:	services.c	stats.h		config.h	dl.h		Unreal.h  	Ultimate.h	Makefile.inc
main.o:		main.c		stats.h 	config.h	dl.h		Makefile.inc
sock.o:		sock.c		stats.h		config.h	dl.h		Makefile.inc
conf.o:		conf.c		stats.h		config.h	dotconf.h	dl.h		Makefile.inc
ircd.o:		ircd.c		stats.h		config.h	dl.h	 	Unreal.h 	Ultimate.h	Makefile.inc
timer.o:	timer.c		stats.h		config.h	dl.h		Makefile.inc
users.o:	users.c		stats.h		config.h	Makefile.inc
ns_help.o:	ns_help.c	stats.h		config.h	Makefile.inc
dl.o:		dl.c		stats.h		config.h	dl.h		Makefile.inc
list.o:		list.c		list.h		Makefile.inc
hash.o:		hash.c		hash.h		Makefile.inc
server.o:	server.c	stats.h		hash.h		hash.c	 	config.h	Makefile.inc
Ultimate.o:	Ultimate.c	stats.h		Ultimate.h	Makefile.inc
Unreal.o:	Unreal.c	stats.h		Unreal.h	Makefile.inc
chans.o:	hash.c		stats.h		Makefile.inc
