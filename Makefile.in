# Makefile for GeoStats
# GeoStats CVS Identification
# $Id: Makefile.in,v 1.16 2002/03/15 12:38:37 fishwaldo Exp $
# makefile originally created by Andy Church.
include Makefile.inc 


OBJS =	chans.o dotconf.o services.o main.o sock.o conf.o ircd.o timer.o users.o \
		ns_help.o dl.o list.o hash.o server.o @IRCD_FILES_OBJS@
SRCS =	chans.c dotconf.c services.c main.c sock.c conf.c ircd.c timer.c users.c \
		ns_help.c dl.c list.c hash.c server.c @IRCD_FILES_SRC@

PROGS = stats chkstats makeconf
CONF = stats.cfg.dist
DOCS = doc/FAQ doc/USERMAN README BUGS AUTHORS COPYING INSTALL LICENCE NEWS TODO
DOCS_PROGS = doc/read-faq doc/read-userman
DATA = data/tlds.nfo
INCLUDES = config.h dl.h dotconf.h hash.h list.h stats.h Ultimate.h Unreal.h

.c.o:
	$(CC) $(CFLAGS) -c $<


all: 	stats modules

modules:
	(cd dl; $(MAKE) $@)


clean:
	(cd dl; $(MAKE) $@)
	/bin/rm -rf *.o stats *.cache Makefile config.status config.h Makefile.inc


stats: $(OBJS)
	$(CC) $(LDFLAGS) $(OBJS)  -o $@

install: stats modules
	$(INSTALL) -m 755 -d @prefix@
	$(INSTALL) -m 755 -d @prefix@/dl
	$(INSTALL) -m 755 -d @prefix@/include
	$(INSTALL) -m 755 -d @prefix@/doc
	$(INSTALL) -m 755 -d @prefix@/data
	$(INSTALL) -m 750 -d @prefix@/logs
	$(INSTALL) -m 755 $(PROGS) @prefix@
	$(INSTALL) -m 644 $(CONF) @prefix@
	$(INSTALL) -m 644 $(DOCS) @prefix@/doc
	$(INSTALL) -m 755 $(DOCS_PROGS) @prefix@/doc
	$(INSTALL) -m 644 $(DATA) @prefix@/data
	$(INSTALL) -m 644 $(INCLUDES) @prefix@/include
	(cd dl; $(MAKE) $@)

# Catch any changes in compilation options at the top of this file
$(OBJS): Makefile

dotconf.o:	dotconf.c	stats.h		config.h	dotconf.h
services.o:	services.c	stats.h		config.h	dl.h		Unreal.h  	Ultimate.h
main.o:		main.c		stats.h 	config.h	dl.h
sock.o:		sock.c		stats.h		config.h	dl.h
conf.o:		conf.c		stats.h		config.h	dotconf.h	dl.h
ircd.o:		ircd.c		stats.h		config.h	dl.h	 	Unreal.h 	Ultimate.h
timer.o:	timer.c		stats.h		config.h	dl.h
users.o:	users.c		stats.h		config.h
ns_help.o:	ns_help.c	stats.h		config.h
dl.o:		dl.c		stats.h		config.h	dl.h
list.o:		list.c		list.h
hash.o:		hash.c		hash.h
server.o:	server.c	stats.h		hash.h		hash.c	 	config.h
Ultimate.o:	Ultimate.c	stats.h		Ultimate.h
Unreal.o:	Unreal.c	stats.h		Unreal.h
chans.o:	hash.c		stats.h